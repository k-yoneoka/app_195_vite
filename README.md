# kintone Customization Template (Vite + React + TypeScript)

kintone アプリの JavaScript/CSS カスタマイズを開発するためのテンプレートです。
プラグイン（zip）形式ではなく、特定のアプリに直接ファイルをアップロードして適用する開発用です。

## 🚀 始め方 (初回セットアップ)

GitHub の「Use this template」からリポジトリを作成し、VS Code でクローンした直後の手順です。

### 1. 依存ライブラリのインストール

まずこれを実行しないと NPM スクリプトが表示されません。

```bash
npm install
```

### 2. 環境変数の設定 (.env)

プロジェクトルートに `.env` ファイルを新規作成し、以下を記述します。 ※カスタマイズ開発では「アプリID」の指定が必須です。

```
KINTONE_BASE_URL=https://(サブドメイン).cybozu.com
KINTONE_USERNAME=(ログイン名)
KINTONE_PASSWORD=(パスワード)
KINTONE_APP_ID=(適用したいアプリのID番号)
```

### 3. マニフェストの確認 (任意)

`customize-manifest.json` で適用範囲 (`scope`) などを設定できます。 デフォルトは `ALL` (全てのユーザー) になっています。

---

## 🛠️ 開発コマンド (NPM スクリプト)

VS Code 左下の「NPM スクリプト」パネルから再生ボタン (▶) で実行できます。

| コマンド | 説明                                                                       |
| -------- | -------------------------------------------------------------------------- |
| `dev`    | ローカル開発サーバー起動 (UIの単体確認用)                                  |
| `build`  | ソースコードをビルドし、`dist/`フォルダに JS/CSS を生成します              |
| `upload` | ビルド結果を kintone アプリにアップロードし、変更を監視 (`--watch`) します |

---

## 📦 開発の流れ

1. `.env` に開発対象のアプリID (`KINTONE_APP_ID`) を設定する
2. コードを編集する (`src/desktop/index.tsx` など)
3. `build` を実行 → `dist/desktop.js` などが生成される
4. `upload` を実行 → 指定したアプリに即座に反映
   - ※ `upload` は監視モードで動き続けます。一度起動しておけば、以降は `build` するだけで勝手にアップロードされます。
5. kintone の画面をリロードして確認

---

## 📂 ディレクトリ構成

```
.
├── src/
│   ├── desktop/             # デスクトップ用コード (一覧画面など)
│   ├── mobile/              # モバイル用コード (必要であれば)
│   └── types/               # TypeScript型定義
├── customize-manifest.json  # カスタマイズの適用設定ファイル
├── dist/                    # ビルド成果物 (自動生成)
├── vite.config.ts           # ビルド設定ファイル
└── upload.mjs               # アップロード用スクリプト
```

## ⚠️ 注意点

- セキュリティ: `.env` は Git にアップロードされません（`.gitignore` 設定済み）。
- アプリID: 別のアプリに適用したい場合は、`.env` の `KINTONE_APP_ID` を書き換えて再アップロードしてください。
- 反映: アップロード後、ブラウザのキャッシュで古いコードが残る場合があります。変更が反映されないときは `Ctrl + F5 (スーパーリロード)` を試してください。
